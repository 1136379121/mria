<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‚£è€…åˆ—è¡¨ - æ‚£è€…ç®¡ç†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: #f5f5f5;
            margin: 0;
            /* ç”±é¡µé¢æ¡†æ¶ç»Ÿä¸€æ§åˆ¶è¾¹è·ï¼ˆé¿å…ä¸æ¡†æ¶ padding å åŠ ï¼‰ */
            padding: 0;
            min-height: 100vh;
        }

        .container-header {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
        }

        .page-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .patient-list-container {
            background: #ffffff;
            border-radius: 8px;
            padding: 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .search-bar {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
            padding: 16px 16px 0 16px;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }

        .search-btn {
            padding: 8px 24px;
            background: #1890ff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .search-btn:hover {
            background: #40a9ff;
        }

        .table-wrapper {
            overflow-x: auto;
            padding: 0 16px;
        }

        .patient-table {
            width: 100%;
            border-collapse: collapse;
        }

        .patient-table th,
        .patient-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        .patient-table th {
            background: #fafafa;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .patient-table td {
            color: #666;
            font-size: 14px;
        }

        .patient-table tbody tr:hover {
            background: #fafafa;
        }

        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }

        .status-treating {
            background: #e6f7ff;
            color: #1890ff;
        }

        .status-pending {
            background: #fff7e6;
            color: #fa8c16;
        }

        .status-completed {
            background: #f6ffed;
            color: #52c41a;
        }

        .pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 8px;
            margin-top: 16px;
            padding: 0 16px 16px 16px;
        }

        .pagination-btn {
            padding: 6px 12px;
            border: 1px solid #d9d9d9;
            background: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .pagination-btn:hover:not(:disabled) {
            color: #1890ff;
            border-color: #1890ff;
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-info {
            color: #666;
            font-size: 14px;
            margin: 0 16px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
    </style>
</head>
<body>
    <div class="patient-list-container">
        <div class="container-header">
            <div class="page-title">æ‚£è€…åˆ—è¡¨</div>
        </div>
        <div class="search-bar">
            <input type="text" class="search-input" placeholder="æœç´¢æ‚£è€…å§“åã€ç—…å†å·..." id="searchInput">
            <button class="search-btn" onclick="searchPatients()">æœç´¢</button>
        </div>

        <div class="table-wrapper">
            <table class="patient-table" id="patientTable">
                <thead>
                    <tr>
                        <th>ç—…å†å·</th>
                        <th>æ‚£è€…å§“å</th>
                        <th>æ€§åˆ«</th>
                        <th>å¹´é¾„</th>
                        <th>è¯Šæ–­</th>
                        <th>æ²»ç–—çŠ¶æ€</th>
                        <th>ä¸»æ²»åŒ»ç”Ÿ</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="patientTableBody">
                    <!-- æ•°æ®å°†åŠ¨æ€åŠ è½½ -->
                </tbody>
            </table>
        </div>

        <div class="pagination" id="pagination">
            <!-- åˆ†é¡µå°†åŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿæ‚£è€…æ•°æ®
        const mockPatients = [
            { id: '001', name: 'å¼ ä¸‰', gender: 'ç”·', age: 45, diagnosis: 'è‚ºç™Œ', status: 'treating', doctor: 'æåŒ»ç”Ÿ' },
            { id: '002', name: 'æå››', gender: 'å¥³', age: 52, diagnosis: 'ä¹³è…ºç™Œ', status: 'treating', doctor: 'ç‹åŒ»ç”Ÿ' },
            { id: '003', name: 'ç‹äº”', gender: 'ç”·', age: 38, diagnosis: 'é¼»å’½ç™Œ', status: 'pending', doctor: 'å¼ åŒ»ç”Ÿ' },
            { id: '004', name: 'èµµå…­', gender: 'å¥³', age: 65, diagnosis: 'é£Ÿç®¡ç™Œ', status: 'treating', doctor: 'æåŒ»ç”Ÿ' },
            { id: '005', name: 'é’±ä¸ƒ', gender: 'ç”·', age: 58, diagnosis: 'è‚ç™Œ', status: 'completed', doctor: 'ç‹åŒ»ç”Ÿ' },
        ];

        let currentPage = 1;
        const pageSize = 10;
        let filteredPatients = [...mockPatients];

        // çŠ¶æ€æ ‡ç­¾æ˜ å°„
        const statusMap = {
            treating: { text: 'æ²»ç–—ä¸­', class: 'status-treating' },
            pending: { text: 'å¾…æ²»ç–—', class: 'status-pending' },
            completed: { text: 'å·²å®Œæˆ', class: 'status-completed' }
        };

        // æ¸²æŸ“æ‚£è€…åˆ—è¡¨
        function renderPatientList() {
            const tbody = document.getElementById('patientTableBody');
            const start = (currentPage - 1) * pageSize;
            const end = start + pageSize;
            const pageData = filteredPatients.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="empty-state">
                            <div class="empty-state-icon">ğŸ“‹</div>
                            <div>æš‚æ— æ‚£è€…æ•°æ®</div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = pageData.map(patient => `
                <tr>
                    <td>${patient.id}</td>
                    <td>${patient.name}</td>
                    <td>${patient.gender}</td>
                    <td>${patient.age}</td>
                    <td>${patient.diagnosis}</td>
                    <td>
                        <span class="status-badge ${statusMap[patient.status].class}">
                            ${statusMap[patient.status].text}
                        </span>
                    </td>
                    <td>${patient.doctor}</td>
                    <td>
                        <a href="#" style="color: #1890ff; text-decoration: none;" onclick="viewPatient('${patient.id}')">æŸ¥çœ‹</a>
                    </td>
                </tr>
            `).join('');

            renderPagination();
        }

        // æ¸²æŸ“åˆ†é¡µ
        function renderPagination() {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(filteredPatients.length / pageSize);

            pagination.innerHTML = `
                <button class="pagination-btn" onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    ä¸Šä¸€é¡µ
                </button>
                <span class="pagination-info">
                    ç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µï¼Œå…± ${filteredPatients.length} æ¡è®°å½•
                </span>
                <button class="pagination-btn" onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    ä¸‹ä¸€é¡µ
                </button>
            `;
        }

        // è·³è½¬é¡µé¢
        function goToPage(page) {
            const totalPages = Math.ceil(filteredPatients.length / pageSize);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderPatientList();
        }

        // æœç´¢æ‚£è€…
        function searchPatients() {
            const keyword = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!keyword) {
                filteredPatients = [...mockPatients];
            } else {
                filteredPatients = mockPatients.filter(patient => 
                    patient.name.toLowerCase().includes(keyword) ||
                    patient.id.toLowerCase().includes(keyword) ||
                    patient.diagnosis.toLowerCase().includes(keyword)
                );
            }
            currentPage = 1;
            renderPatientList();
        }

        // æŸ¥çœ‹æ‚£è€…è¯¦æƒ…
        function viewPatient(patientId) {
            const url = `æ‚£è€…è¯¦æƒ…/æ‚£è€…è¯¦æƒ….html?patientId=${encodeURIComponent(patientId)}`;

            // ä¼˜å…ˆï¼šè‹¥åœ¨é¡µé¢æ¡†æ¶ iframe ä¸­æ‰“å¼€ï¼Œåˆ™è¯·æ±‚çˆ¶é¡µé¢åœ¨å†…å®¹åŒºæ‰“å¼€è¯¦æƒ…é¡µï¼ˆé›†æˆåˆ°é¡µé¢æ¡†æ¶å†…å®¹éƒ¨åˆ†ï¼‰
            try {
                if (window.parent && window.parent !== window) {
                    // æ–¹å¼1ï¼šè°ƒç”¨çˆ¶é¡µé¢å…¬å¼€æ–¹æ³•
                    if (typeof window.parent.openContent === 'function') {
                        window.parent.openContent(url);
                        return;
                    }

                    // æ–¹å¼2ï¼špostMessageï¼ˆæ›´é€šç”¨ï¼‰
                    window.parent.postMessage({ type: 'open-content', url }, '*');

                    const frame = window.parent.document.getElementById('contentFrame');
                    if (frame && frame.tagName === 'IFRAME') {
                        frame.src = url;
                        return;
                    }
                }
            } catch (e) {
                // ignore cross-origin / sandbox restrictions (åŸå‹ï¼šå°½é‡å…¼å®¹)
            }
            // å¦åˆ™åœ¨å½“å‰é¡µæ‰“å¼€ï¼ˆé»˜è®¤é›†æˆåˆ°é¡µé¢æ¡†æ¶å†…å®¹åŒºï¼Œä¸å†æ–°å¼€æ ‡ç­¾ï¼‰
            window.location.href = url;
        }

        // å›è½¦æœç´¢
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchPatients();
            }
        });

        // åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            renderPatientList();
        });
    </script>
</body>
</html>
