# 菜单管理

## 一、主界面

![主界面示意图](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/QvjnA3jrj9zKyOXo/img/14f5edbd-4e4e-4d53-ac33-16fe8b2232fa.png)

## 二、需求描述

### 1. 菜单布局模式

| 功能点 | 功能描述 | 交互样式 | 备注 |
| --- | --- | --- | --- |
| 菜单布局模式配置 | **出厂默认**：竖向布局。<br><br>**配置方式**：在“菜单管理”页面配置，仅超级管理员权限可修改；修改后对所有用户界面生效。<br><br>**竖向布局：**<br>- 菜单竖向按序排布在页面最左侧。<br><br>**横向布局：**<br>- 菜单横向按序排布在页面最顶部。<br>- 二级菜单默认隐藏；点击一级目录后显示该一级目录下的二级菜单；点击其他区域二级菜单自动收起。 | ![竖向布局](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/QvjnA3jrj9zKyOXo/img/f2791576-79cc-42f2-8ec8-27cb2a184a7b.png)<br>![横向布局](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/QvjnA3jrj9zKyOXo/img/fc060591-9448-4418-beb7-1bd3219f6bc7.png)<br>![菜单管理配置](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/QvjnA3jrj9zKyOXo/img/2812446c-159c-4cac-8463-e0ea0aa5719e.png) |  |

### 2. 新增子菜单

**新增范围**：目前仅支持在一级目录下新增子级菜单。

| 功能点 | 功能描述 | 交互样式 | 备注 |
| --- | --- | --- | --- |
| 内置菜单 | **不可删除。**<br><br>包含：患者登记 / 患者列表 / CT预约 / CT排队叫号 / 正常组织勾画 / 靶区勾画 / 勾画审核 / 计划设计 / 组长审核 / 医师核准 / 计划复核 / 复位申请 / 治疗预约 / 排队叫号 / 治疗执行 / 后装治疗 / 自适应治疗 / 费用确认 / 流程预警 / 全部统计模块 / 全部配置模块 |  |  |
| 新增信息 | 在对应模块点击【新增子菜单】按钮，在弹窗中填写：<br><br>- **菜单名称**：最多20字；不支持输入特殊字符 `\\ / : * ? \" . < > \\|`，否则提示“菜单名称不能含有特殊字符”（表单校验提示样式）。<br>- **排序**：默认值为“当前目录下菜单数量 + 1”，可修改。<br>- **当前阶段**：选项值显示“流程管理”中的全部流程名称及节点名称，支持多选。<br><br>新增成功后：<br>- 弹窗 toast 提示“当前菜单配置已变动，请重新登录”；重新登录后，新增菜单在导航栏生效。<br>- 基础管理-角色权限的“角色授权”中菜单同步添加（编辑/删除同理），其中数据权限默认选中“仅能查看自己所在科室的全部患者”。<br>- 新增后的菜单页面默认都有“导出 Excel”功能。 | ![新增子菜单弹窗](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4j6OJ5w0gW576q3p/img/51b5b99d-84e2-4220-b7ee-3f3fa08df08b.png) |  |
| 勾画管理 / 计划管理 / 后装管理 / 自适应管理 | 页面结构：<br><br>- 左侧：当前节点待办列表（列项字段按配置显示），支持搜索。<br>- 排序：默认按“上一步完成时间”升序；支持切换升/降序。<br>- 右侧：当前选中行的患者进度详情，包含：<br>  - **基础信息**：患者头像 / 高风险标识 / 姓名 / 性别 / 年龄 / 病案号 / 放疗号 / 主管医生。<br>  - **进度表单**：默认显示当前任务对应的流程名称和进度条；可切换流程（显示对应登记中的全部流程列表）；节点显示对应的表单信息；支持的操作与患者详情一致。<br>- 点击“患者详情”按钮进入患者详情页。 | ![任务处理示意图](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4j6OJ5w0gW576q3p/img/16e993b8-c257-42d2-8708-10ea9b5b3cc8.png) |  |

### 3. 编辑菜单

| 功能点 | 功能描述 | 交互样式 | 备注 |
| --- | --- | --- | --- |
| 编辑范围 | - 目前仅支持对“定位管理 / 勾画管理 / 计划管理 / 复位管理 / 治疗管理”模块的菜单，以及自定义新增的菜单进行编辑。<br>- 编辑成功后，角色权限配置中的菜单会同步修改，导航栏菜单也会同步修改。<br>- 新增时填写的内容均可编辑，同时可编辑“表格列项 / 查询条件”的信息项。 |  |  |
| 表格列项设置 | **新增列项**：点击按钮显示弹窗，下拉值为“系统字段 / 基本信息 / 程/段信息”，可按表单筛选字段，支持多选。<br><br>**系统字段**（示例）：诊断 / 计划物理师 / 审批物理师 / 计划物理组 / 当前阶段 / 放疗次数 / 程/段日期 / 登记日期 / 登记人员 / 定位机房 / 治疗机房 / 上一步完成时间 / 计划系统 / 治疗技术 / 截止时间 / 主管医生 / 主管医生组 / 验证设备（展示当前登记全部流程值）/ 预约时间 / 扫描方式 / 扫描部位 / QA状态 / 首次治疗时间 / 最近治疗时间。<br><br>**列项移除**：点击按钮取消字段展示，任意字段均可移除。<br>**列项标题重命名**：鼠标悬停标题列显示编辑按钮；点击后可编辑；确定保存，取消放弃。<br>**列项顺序调整**：拖动调整列项顺序。<br>**列项恢复默认**：默认按出厂预设默认列项；若用户使用过“设为默认”，则按用户上次保存的默认列项。<br>**列项设为默认**：将当前用户设置存为最新默认值。 |  |  |
| 查询条件设置 | **关键词检索**：无需配置，每个子菜单默认支持；输入患者姓名 / 病案号 / 放疗号 / 身份证号 / 病人ID 关键字可即时搜索。<br><br>**主管医生**：带搜索的下拉多选；选项来自用户管理中用户类型为“主管医生”的用户姓名；患者列表/任务列表需记住上一次选择（退出登录后无需记住）。<br><br>**物理师**：带搜索的下拉多选；选项来自用户管理中用户类型为“物理师”的用户姓名；患者列表/任务列表需记住上一次选择（退出登录后无需记住）。<br><br>**治疗机器**：多选；选项值为预约项目为“治疗”的机房名称；默认空；需要记住上一次选择。<br><br>**预约日期**：默认当天，支持切换。<br><br>**院区**：支持搜索的下拉单选；选项来自医院信息配置；默认禁用。<br><br>**高级筛选**：见右侧交互样式（包含：主诊医生、患者标签、流程状态、治疗状态、QA状态、放疗部位、治疗技术、疾病种类、临床诊断、临床分期、乳腺手术方式、验证设备、首次治疗日期、登记人员、流程、患者来源等）。<br><br>**恢复默认**：出厂默认按通用出厂配置；若用户使用过“设为默认”，则按用户上次保存的默认值。 | 高级筛选：<br>![高级筛选示意图](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/4j6OJ5w0gW576q3p/img/5a0df449-db58-41e9-a948-035b013b20ce.png) |  |
| 患者列表统计项 | 显示到列表统计：<br>- 默认为否。<br>- 选择“是”后，患者列表任务概览中显示该菜单名称为统计项，并实时统计任务数量。<br><br>出厂默认开启统计项显示的菜单：定位申请、CT执行、靶区勾画、勾画审核、计划申请、计划设计、组长审核、医生审核、治疗执行、治疗小结。<br><br>约束：只有可关联“当前阶段”的菜单，才可以配置“显示到列表统计”；其他菜单隐藏该配置项。 | ![统计项示意图](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/QvjnA3jrj9zKyOXo/img/3cca86e7-048e-417a-b7d8-8fd2dbd9e3da.png) |  |

### 4. 删除菜单

| 功能点 | 功能描述 | 交互说明 | 备注 |
| --- | --- | --- | --- |
| 删除 | - 目前仅支持对自定义新增的菜单进行删除。<br>- 点击确认并删除成功后：角色权限配置中的菜单会被删除，导航栏菜单也会同步删除。 |  |  |

### 5. 菜单顺序调整

| 功能点 | 功能描述 | 交互说明 | 备注 |
| --- | --- | --- | --- |
| 顺序调整 | **一级目录：**<br>- 支持同级调整顺序；调整后二级菜单同步移动。例：横向菜单模式把“患者登记”放到最右侧。<br>- 若一级菜单是实际页面，可支持设置为二级菜单。<br><br>**二级菜单：**<br>- 可将二级菜单调整为一级；也可在原目录内上下移动。 | ![顺序调整示意图](https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/QvjnA3jrj9zKyOXo/img/4b35b86f-5e9d-4624-b65c-6cd9b246a4cf.png) |  |

### 6. 菜单栏待办标识

| 功能点 | 功能描述 | 交互说明 | 备注 |
| --- | --- | --- | --- |
| 待办标识 | 在菜单栏中显示列表中的待办数量；与当前账号的数据权限有关；列表中输入筛选条件不影响数值。<br><br>涉及菜单：<br>- **定位管理模块**：\[CT预约\]显示该菜单待预约数量；\[CT排队叫号\]不显示；其他新增子菜单均显示。<br>- **勾画管理模块**：模块下全部菜单显示。<br>- **计划管理模块**：模块下全部菜单显示。<br>- **复位管理模块**：模块下全部菜单显示。<br>- **治疗管理模块**：\[治疗预约\]显示该菜单下所有机房的待预约数量之和；\[排队叫号\]不显示；其他新增子菜单均显示。<br><br>触发更新：点击任意菜单名称后更新；系统每30s自动轮询更新。 |  |  |