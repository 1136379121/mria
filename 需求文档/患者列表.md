# 功能点需求描述文档 - 患者列表（患者管理）

## 1. 功能基本信息

### 1.1 功能名称
患者列表（患者管理）

### 1.2 所属模块
患者管理

### 1.3 优先级
P0-核心

### 1.4 创建日期
2026-01-20

### 1.5 最后更新日期
2026-01-20

---

## 2. 功能概述

### 2.1 功能描述
- 展示患者列表数据，支持关键字段展示（病历号、姓名、性别、年龄、诊断、治疗状态、主治医生）。
- 支持关键字搜索（姓名 / 病历号 / 诊断）。
- 支持分页浏览（上一页 / 下一页 + 页码与总条数信息）。
- 支持“查看”操作入口（原型为弹窗提示，真实系统可跳转患者详情页）。

### 2.2 业务背景
患者管理模块的日常入口通常从患者列表开始，用户需通过搜索和分页快速定位目标患者并进入后续业务处理。

### 2.3 目标用户
- **主要用户**: 具有患者管理访问权限的业务用户（医生、护士、技师、物理师、管理员等）

### 2.4 业务价值
- 提升患者信息检索效率，降低查找成本。
- 统一患者入口，支撑后续流程操作（查看详情/进入治疗流程等）。

---

## 3. 用户故事

### 3.1 用户故事描述
**作为** 患者管理模块用户  
**我希望** 通过患者列表检索并定位目标患者  
**以便** 进入患者详情或后续治疗流程操作

### 3.2 用户场景

#### 场景1：进入页面查看患者列表
- **前置条件**: 用户已进入患者管理模块并打开“患者列表”页面
- **操作步骤**:
  1. 打开“患者列表”
  2. 系统加载并渲染患者列表
- **预期结果**: 展示列表表格与分页信息；若无数据展示空态

#### 场景2：关键字搜索患者
- **前置条件**: 页面已加载
- **操作步骤**:
  1. 在搜索框输入关键字（姓名/病历号/诊断）
  2. 点击“搜索”或按 Enter
- **预期结果**: 列表刷新为匹配结果；分页回到第 1 页

#### 场景3：分页浏览
- **前置条件**: 搜索结果或列表数据存在多页
- **操作步骤**:
  1. 点击“上一页/下一页”
- **预期结果**: 列表切换到对应页；页码信息同步更新；不可用按钮置灰

#### 场景4：查看患者
- **前置条件**: 列表存在患者记录
- **操作步骤**:
  1. 点击某行“查看”
- **预期结果**: 原型弹窗提示患者 ID；真实系统可跳转“患者详情”页

---

## 4. 功能详细说明

### 4.1 功能特性列表
- [x] 页面标题展示（单行，超出省略）
- [x] 搜索框（关键字）+ 搜索按钮
- [x] 列表表格展示
- [x] 治疗状态徽标展示（不同状态不同颜色）
- [x] 分页（上一页/下一页/页码信息/总条数）
- [x] 空态展示（无数据时）
- [x] “查看”操作入口
- [x] Enter 键触发搜索

### 4.2 核心功能点

#### 4.2.1 页面初始化与数据渲染
**描述**: 页面加载后渲染患者列表数据。  
**触发条件**: 页面 `DOMContentLoaded`。  
**处理逻辑**:
- 加载患者数据集合（原型为内置模拟数据）。
- 按分页参数截取当前页数据并渲染到表格。
- 渲染分页信息（当前页、总页数、总条数）。  
**输出结果**: 用户看到表格数据与分页。

#### 4.2.2 关键字搜索
**描述**: 根据关键字过滤患者列表。  
**触发条件**: 点击“搜索”按钮或搜索框按 Enter。  
**处理逻辑**:
- 获取关键字并做 trim；为空则恢复全量列表。
- 过滤字段（原型实现）：
  - `患者姓名(name)` 包含关键字
  - `病历号(id)` 包含关键字
  - `诊断(diagnosis)` 包含关键字
- 将当前页重置为第 1 页，并重新渲染列表与分页。  
**输出结果**: 列表展示匹配结果。

#### 4.2.3 分页
**描述**: 支持分页浏览患者列表。  
**触发条件**: 点击“上一页/下一页”。  
**处理逻辑**:
- 计算总页数：\( totalPages = \lceil totalCount / pageSize \rceil \)
- 若目标页越界则不处理。
- 切换 `currentPage` 后重新渲染表格与分页信息。
- 边界状态：当前页为 1 时“上一页”禁用；当前页为最后页时“下一页”禁用。  
**输出结果**: 用户可逐页浏览数据。

#### 4.2.4 治疗状态展示
**描述**: 以徽标样式展示患者治疗状态。  
**触发条件**: 列表渲染。  
**处理逻辑**:
- 状态映射（原型实现）：
  - `treating` → 文案“治疗中”，蓝色
  - `pending` → 文案“待治疗”，橙色
  - `completed` → 文案“已完成”，绿色  
**输出结果**: 状态清晰可辨。

#### 4.2.5 查看患者
**描述**: 提供查看入口。  
**触发条件**: 点击某行“查看”。  
**处理逻辑**:
- 原型行为：弹窗提示患者 ID。
- 真实系统建议：跳转至患者详情页（如 `患者详情.html?id=xxx` 或路由页面）。  
**输出结果**: 用户可进入患者详情/后续流程。

### 4.3 边界条件
- **正常情况**: 有数据时按分页展示，搜索返回匹配结果。
- **异常情况**:
  - 搜索无匹配：表格展示空态“暂无患者数据”。
  - 页码越界：不进行跳页。
- **边界情况**:
  - 标题过长：单行省略号显示（不换行）。

### 4.4 业务规则
1. 搜索关键字为空时，恢复展示全部患者。
2. 搜索后分页必须回到第 1 页。
3. 分页按钮需根据当前页与总页数控制可用/禁用状态。

---

## 5. 业务流程

### 5.1 主流程
```
流程步骤：
1. 用户进入“患者列表”
2. 系统加载并渲染列表 + 分页
3. 用户输入关键字并搜索（可选）
4. 系统过滤数据并重置到第1页展示结果（可选）
5. 用户分页浏览（可选）
6. 用户点击“查看”进入详情（可选）
```

### 5.2 异常流程
- 搜索无匹配 → 空态提示

---

## 6. 界面设计需求

### 6.1 页面/界面列表
- **患者列表页**:
  - 路径: `/`（原型文件：`原型/患者列表.html`）
  - 说明: 搜索 + 列表 + 分页 + 查看入口

### 6.2 界面元素

#### 6.2.1 页面标题
- **类型**: 文本
- **位置**: 容器顶部（白色卡片头部）
- **功能**: 标识当前页面“患者列表”
- **状态**: 单行省略号

#### 6.2.2 搜索栏
- **类型**: 输入框 + 按钮
- **位置**: 标题下方
- **功能**: 关键字搜索（姓名/病历号/诊断）
- **交互**: 点击“搜索”或按 Enter 触发

#### 6.2.3 列表表格
- **类型**: 表格
- **位置**: 搜索栏下方
- **列**:
  - 病历号
  - 患者姓名
  - 性别
  - 年龄
  - 诊断
  - 治疗状态（徽标）
  - 主治医生
  - 操作（查看）

#### 6.2.4 分页
- **类型**: 上一页 / 下一页按钮 + 文本信息
- **位置**: 列表底部右侧
- **交互**: 按页切换；边界禁用

#### 6.2.5 空态
- **类型**: 表格内占位行
- **触发**: 当前页无数据
- **内容**: 图标 + “暂无患者数据”

### 6.3 交互设计
- 搜索：点击按钮或 Enter 触发，自动回到第 1 页
- 行 hover：行背景变浅
- 查看：点击链接触发查看动作（原型为 alert）

### 6.4 响应式要求
- **桌面端**: 卡片容器内展示；表格完整展示
- **移动端/窄屏**: 表格区域支持横向滚动（`overflow-x: auto`）

### 6.5 设计参考
- 原型页面：`原型/患者列表.html`

---

## 7. 数据需求

### 7.1 输入数据
| 字段名称 | 类型 | 必填 | 格式要求 | 说明 |
|---------|------|------|---------|------|
| keyword | String | 否 | 0-? | 搜索关键字 |
| page | Number | 是 | >=1 | 当前页码 |
| pageSize | Number | 是 | >0 | 每页条数（原型为 10） |
| patients | Array | 否 | - | 患者数据集合（原型为模拟数据） |

### 7.2 输出数据
| 字段名称 | 类型 | 说明 |
|---------|------|------|
| tableRows | Array | 当前页渲染的患者行数据 |
| totalCount | Number | 数据总条数 |
| totalPages | Number | 总页数 |

### 7.3 数据验证规则
- 关键字：允许为空；非空时按包含匹配过滤（大小写不敏感）
- 页码：越界不切换

### 7.4 数据存储
- 原型不做持久化存储；真实系统建议由后端接口分页返回。

---

## 10. 安全要求

### 10.1 权限控制
- **访问权限**: 具备患者管理模块访问权限的用户可访问
- **操作权限**: “查看”需要具备患者查看权限（原型未实现权限控制）

---

## 16. 变更记录

| 版本 | 日期 | 修改人 | 修改内容 |
|------|------|--------|---------|
| v1.0 | 2026-01-20 | Cursor | 根据 `原型/患者列表.html` 整理为需求文档 |

---

**文档结束**

